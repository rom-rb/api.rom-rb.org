<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: ROM::Relation::ClassInterface
  
    &mdash; Documentation by YARD 0.9.24
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "ROM::Relation::ClassInterface";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">Relation</a></span></span>
     &raquo; 
    <span class="title">ClassInterface</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: ROM::Relation::ClassInterface
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>Dry::Core::Constants</dd>
  </dl>
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">ROM::Relation</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rom/relation/class_interface.rb</dd>
  </dl>
  
</div>

<div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#[]-instance_method" title="#[] (instance method)">#<strong>[]</strong>(adapter)  &#x21d2; Class </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return adapter-specific relation subclass.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#forward-instance_method" title="#forward (instance method)">#<strong>forward</strong>(*methods)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Dynamically define a method that will forward to the dataset and wrap response in the relation itself.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#schema-instance_method" title="#schema (instance method)">#<strong>schema</strong>(dataset = nil, as: nil, infer: false, &amp;block)  &#x21d2; Schema </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Specify canonical schema for a relation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#use-instance_method" title="#use (instance method)">#<strong>use</strong>(plugin, _options = EMPTY_HASH)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Include a registered plugin in this relation class.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#view-instance_method" title="#view (instance method)">#<strong>view</strong>(*args, &amp;block)  &#x21d2; Symbol </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define a relation view with a specific schema.</p>
</div></span>
  
</li>

      
    </ul>
  


  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="[]-instance_method">
  
    #<strong>[]</strong>(adapter)  &#x21d2; <tt>Class</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return adapter-specific relation subclass</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">Relation</a></span></span><span class='lbracket'>[</span><span class='symbol'>:memory</span><span class='rbracket'>]</span>
<span class='comment'># =&gt; ROM::Memory::Relation</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Class</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rom/relation/class_interface.rb', line 142</span>

<span class='kw'>def</span> <span class='op'>[]</span><span class='lparen'>(</span><span class='id identifier rubyid_adapter'>adapter</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='period'>.</span><span class='id identifier rubyid_adapters'>adapters</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_adapter'>adapter</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='symbol'>:Relation</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'>KeyError</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../AdapterNotPresentError.html" title="ROM::AdapterNotPresentError (class)">AdapterNotPresentError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../AdapterNotPresentError.html#initialize-instance_method" title="ROM::AdapterNotPresentError#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_adapter'>adapter</span><span class='comma'>,</span> <span class='symbol'>:relation</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="forward-instance_method">
  
    #<strong>forward</strong>(*methods)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Dynamically define a method that will forward to the dataset and wrap response in the relation itself</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>SomeAdapterRelation</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">Relation</a></span></span>
  <span class='id identifier rubyid_forward'>forward</span> <span class='symbol'>:super_query</span>
<span class='kw'>end</span></code></pre>
    
  </div>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


289
290
291
292
293
294
295
296
297</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rom/relation/class_interface.rb', line 289</span>

<span class='kw'>def</span> <span class='id identifier rubyid_forward'>forward</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_methods'>methods</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_methods'>methods</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_method'>method</span><span class='op'>|</span>
    <span class='id identifier rubyid_class_eval'>class_eval</span> <span class='heredoc_beg'>&lt;&lt;-RUBY</span><span class='comma'>,</span> <span class='kw'>__FILE__</span><span class='comma'>,</span> <span class='kw'>__LINE__</span> <span class='op'>+</span> <span class='int'>1</span>
<span class='tstring_content'>      def </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_method'>method</span><span class='embexpr_end'>}</span><span class='tstring_content'>(*args, &amp;block)
        new(dataset.__send__(:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_method'>method</span><span class='embexpr_end'>}</span><span class='tstring_content'>, *args, &amp;block))
      end
</span><span class='heredoc_end'>    RUBY
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="schema-instance_method">
  
    #<strong>schema</strong>(dataset = nil, as: nil, infer: false, &amp;block)  &#x21d2; <tt><span class='object_link'><a href="../Schema.html" title="ROM::Schema (class)">Schema</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Specify canonical schema for a relation</p>

<p>With a schema defined commands will set up a type-safe input handler automatically</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>Users</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">Relation</a></span></span><span class='lbracket'>[</span><span class='symbol'>:sql</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_schema'>schema</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_attribute'>attribute</span> <span class='symbol'>:id</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Types.html" title="ROM::Types (module)">Types</a></span></span><span class='op'>::</span><span class='const'>Serial</span>
    <span class='id identifier rubyid_attribute'>attribute</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Types.html" title="ROM::Types (module)">Types</a></span></span><span class='op'>::</span><span class='const'>String</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># access schema
</span><span class='const'>Users</span><span class='period'>.</span><span class='id identifier rubyid_schema'>schema</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>dataset</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>An optional dataset name</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>infer</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to do an automatic schema inferring</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Schema.html" title="ROM::Schema (class)">Schema</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rom/relation/class_interface.rb', line 170</span>

<span class='kw'>def</span> <span class='id identifier rubyid_schema'>schema</span><span class='lparen'>(</span><span class='id identifier rubyid_dataset'>dataset</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>as:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>infer:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@schema</span><span class='rparen'>)</span>
    <span class='ivar'>@schema</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_block'>block</span> <span class='op'>||</span> <span class='id identifier rubyid_infer'>infer</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dataset'>dataset</span><span class='lparen'>(</span><span class='id identifier rubyid_dataset'>dataset</span><span class='comma'>,</span> <span class='label'>deprecation:</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_dataset'>dataset</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_as'>as</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_register_as'>register_as</span><span class='lparen'>(</span><span class='id identifier rubyid_as'>as</span><span class='comma'>,</span> <span class='label'>deprecation:</span> <span class='kw'>false</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_register_as'>register_as</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dataset'>dataset</span><span class='comma'>,</span> <span class='label'>deprecation:</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_register_as'>register_as</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='const'>Name</span><span class='lbracket'>[</span><span class='id identifier rubyid_register_as'>register_as</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dataset'>dataset</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_inferrer'>inferrer</span> <span class='op'>=</span> <span class='id identifier rubyid_infer'>infer</span> <span class='op'>?</span> <span class='id identifier rubyid_schema_inferrer'>schema_inferrer</span> <span class='op'>:</span> <span class='kw'>nil</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_schema_class'>schema_class</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../ROM.html#MissingSchemaClassError-constant" title="ROM::MissingSchemaClassError (constant)">MissingSchemaClassError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_dsl'>dsl</span> <span class='op'>=</span> <span class='id identifier rubyid_schema_dsl'>schema_dsl</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='label'>schema_class:</span> <span class='id identifier rubyid_schema_class'>schema_class</span><span class='comma'>,</span> <span class='label'>inferrer:</span> <span class='id identifier rubyid_inferrer'>inferrer</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>

    <span class='ivar'>@schema</span> <span class='op'>=</span> <span class='id identifier rubyid_dsl'>dsl</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="use-instance_method">
  
    #<strong>use</strong>(plugin, _options = EMPTY_HASH)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Include a registered plugin in this relation class</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>plugin</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    
    


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


306
307
308</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rom/relation/class_interface.rb', line 306</span>

<span class='kw'>def</span> <span class='id identifier rubyid_use'>use</span><span class='lparen'>(</span><span class='id identifier rubyid_plugin'>plugin</span><span class='comma'>,</span> <span class='id identifier rubyid__options'>_options</span> <span class='op'>=</span> <span class='const'>EMPTY_HASH</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='period'>.</span><span class='id identifier rubyid_plugin_registry'>plugin_registry</span><span class='period'>.</span><span class='id identifier rubyid_relations'>relations</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='id identifier rubyid_plugin'>plugin</span><span class='comma'>,</span> <span class='id identifier rubyid_adapter'>adapter</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_apply_to'>apply_to</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="view-instance_method">
  
    
      <span class="overload">#<strong>view</strong>(name, schema, &amp;block)  &#x21d2; <tt>Symbol</tt> </span>
    
      <span class="overload">#<strong>view</strong>(name, &amp;block)  &#x21d2; <tt>Symbol</tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Define a relation view with a specific schema</p>

<p>Explicit relation views allow relation composition with auto-mapping in repositories. It&#39;s useful for cases like defining custom views for associations where relations (even from different databases) can be composed together and automatically mapped in memory to structs.</p>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>view</strong>(name, schema, &amp;block)  &#x21d2; <tt>Symbol</tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>View with the canonical schema</p>
</div></p>
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>Users</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">Relation</a></span></span><span class='lbracket'>[</span><span class='symbol'>:sql</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_view'>view</span><span class='lparen'>(</span><span class='symbol'>:listing</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>View with a projected schema</p>
</div></p>
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>Users</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">Relation</a></span></span><span class='lbracket'>[</span><span class='symbol'>:sql</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_view'>view</span><span class='lparen'>(</span><span class='symbol'>:listing</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='period'>.</span><span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='symbol'>:id</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
  </div>


</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>view</strong>(name, &amp;block)  &#x21d2; <tt>Symbol</tt> </span>
        <div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>View with the canonical schema and arguments</p>
</div></p>
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>Users</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">Relation</a></span></span><span class='lbracket'>[</span><span class='symbol'>:sql</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_view'>view</span><span class='lparen'>(</span><span class='symbol'>:by_name</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
    <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>View with projected schema and arguments</p>
</div></p>
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>Users</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">Relation</a></span></span><span class='lbracket'>[</span><span class='symbol'>:sql</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_view'>view</span><span class='lparen'>(</span><span class='symbol'>:by_name</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_schema'>schema</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='symbol'>:id</span><span class='comma'>,</span> <span class='symbol'>:name</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_relation'>relation</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span> <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>View with a schema extended with foreign attributes</p>
</div></p>
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>Users</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../ROM.html" title="ROM (module)">ROM</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Relation.html" title="ROM::Relation (class)">Relation</a></span></span><span class='lbracket'>[</span><span class='symbol'>:sql</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_view'>view</span><span class='lparen'>(</span><span class='symbol'>:index</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_schema'>schema</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='id identifier rubyid_relations'>relations</span><span class='lbracket'>[</span><span class='symbol'>:tasks</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:title</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_relation'>relation</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span> <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
  </div>


</div>
      </li>
    
  </ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>view method name</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rom/relation/class_interface.rb', line 244</span>

<span class='kw'>def</span> <span class='id identifier rubyid_view'>view</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_arity'>arity</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>header must be set as second argument</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_schema_fn'>new_schema_fn</span><span class='comma'>,</span> <span class='id identifier rubyid_relation_block'>relation_block</span> <span class='op'>=</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
      <span class='const'><span class='object_link'><a href="ViewDSL.html" title="ROM::Relation::ViewDSL (class)">ViewDSL</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Relation.html#new-instance_method" title="ROM::Relation#new (method)">new</a></span></span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>
    <span class='kw'>else</span>
      <span class='lbracket'>[</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

  <span class='id identifier rubyid_schemas'>schemas</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>2</span>
      <span class='id identifier rubyid_schema'>schema</span><span class='period'>.</span><span class='id identifier rubyid_project'>project</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_new_schema_fn'>new_schema_fn</span>
    <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_relation_block'>relation_block</span><span class='period'>.</span><span class='id identifier rubyid_arity'>arity</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_auto_curry_guard'>auto_curry_guard</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_define_method'>define_method</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_relation_block'>relation_block</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_auto_curry'>auto_curry</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_schemas'>schemas</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_define_method'>define_method</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_schemas'>schemas</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='lparen'>(</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_relation_block'>relation_block</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Jan 25 18:50:37 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.24 (ruby-2.6.5).
</div>

    </div>
  </body>
</html>